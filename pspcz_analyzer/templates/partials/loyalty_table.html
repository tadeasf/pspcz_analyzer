<table>
    <thead>
        <tr>
            <th>{{ _("th.rank") }}</th>
            <th>{{ _("th.mp") }}</th>
            <th>{{ _("th.party") }}</th>
            <th>{{ _("th.active_votes") }}</th>
            <th>{{ _("th.rebellions") }}</th>
            <th>{{ _("th.rebellion_pct") }}</th>
        </tr>
    </thead>
    <tbody>
        {% for row in rows %}
        <tr>
            <td>{{ loop.index }}</td>
            <td>{{ row.jmeno }} {{ row.prijmeni }}</td>
            <td>{{ row.party or "N/A" }}</td>
            <td>{{ "{:,}".format(row.active_votes) }}</td>
            <td>{{ "{:,}".format(row.rebellions) }}</td>
            <td>{{ "%.1f"|format(row.rebellion_pct) }}%</td>
        </tr>
        {% if row.rebellion_votes %}
        <tr>
            <td colspan="6" style="padding: 0 0 0 2rem; border-top: none;">
                <details>
                    <summary>
                        {{ _("rebellion_votes.show").format(count=row.rebellion_votes | length) }}
                    </summary>
                    <div class="overflow-auto">
                        <table style="font-size: 0.85rem; margin: 0.5rem 0;">
                            <thead>
                                <tr>
                                    <th>{{ _("th.date") }}</th>
                                    <th>{{ _("th.description") }}</th>
                                    <th>{{ _("th.mp_vote") }}</th>
                                    <th>{{ _("th.party_vote") }}</th>
                                    <th>{{ _("th.links") }}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for v in row.rebellion_votes %}
                                <tr>
                                    <td style="white-space: nowrap;">{{ v.datum }}</td>
                                    <td>{{ v.nazev_dlouhy[:120] }}{% if v.nazev_dlouhy|length > 120 %}&hellip;{% endif %}</td>
                                    <td>
                                        {% if v.mp_vote == "A" %}
                                        <span class="vote-yes">{{ _("vote.yes") }}</span>
                                        {% elif v.mp_vote == "B" %}
                                        <span class="vote-no">{{ _("vote.no") }}</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if v.party_direction == "A" %}
                                        <span class="vote-yes">{{ _("vote.yes") }}</span>
                                        {% elif v.party_direction == "B" %}
                                        <span class="vote-no">{{ _("vote.no") }}</span>
                                        {% endif %}
                                    </td>
                                    <td style="white-space: nowrap;">
                                        <a href="https://www.psp.cz/sqw/hlasy.sqw?G={{ v.id_hlasovani }}" target="_blank">psp.cz</a>
                                        {% if v.tisk_url %}
                                        &middot; <a href="{{ v.tisk_url }}" target="_blank">tisk</a>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </details>
            </td>
        </tr>
        {% endif %}
        {% endfor %}
    </tbody>
</table>
{% if not rows %}
<p>{{ _("no_data_filters") }}</p>
{% endif %}
