<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Czech Parliamentary Voting Analyzer â€” OSINT tool for psp.cz open data">
    <meta name="theme-color" content="#3C71AC">
    <title>{% block title %}Czech Parliament Analyzer{% endblock %}</title>
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://unpkg.com/htmx.org@2.0.4"></script>
</head>
<body>
    <header class="site-header">
        <div class="header-inner">
            <a href="/" class="site-logo">
                <img src="/static/logo-psp.png" alt="Poslanecka snemovna">
            </a>
            <div class="header-right">
                <span class="header-title">Analyzer</span>
                <select class="period-select" onchange="switchPeriod(this.value)" aria-label="Electoral period">
                    {% for p in periods %}
                    <option value="{{ p.number }}" {% if p.number == period %}selected{% endif %}>
                        {{ p.number }}. period ({{ p.label }})
                    </option>
                    {% endfor %}
                </select>
            </div>
        </div>
    </header>

    <nav class="site-nav">
        <div class="nav-inner">
            <a href="/?period={{ period }}" {% if active_page == "index" %}aria-current="page"{% endif %}>Dashboard</a>
            <a href="/loyalty?period={{ period }}" {% if active_page == "loyalty" %}aria-current="page"{% endif %}>Party Loyalty</a>
            <a href="/attendance?period={{ period }}" {% if active_page == "attendance" %}aria-current="page"{% endif %}>Attendance</a>
            <a href="/similarity?period={{ period }}" {% if active_page == "similarity" %}aria-current="page"{% endif %}>Similarity</a>
            <a href="/votes?period={{ period }}" {% if active_page == "votes" %}aria-current="page"{% endif %}>Votes</a>
            <a href="/docs">API Docs</a>
        </div>
    </nav>

    <main class="container">
        {% block content %}{% endblock %}
    </main>

    <footer class="site-footer">
        <p>Data source: <a href="https://www.psp.cz/sqw/hp.sqw?k=1300" target="_blank">psp.cz open data</a> | OSINT Educational Project</p>
    </footer>

    <script>
        function switchPeriod(newPeriod) {
            var main = document.querySelector('main');
            main.classList.add('skeleton');
            main.setAttribute('aria-busy', 'true');
            main.innerHTML =
                '<div class="skeleton-pulse skeleton-heading"></div>' +
                '<div class="skeleton-pulse skeleton-line skeleton-line-medium"></div>' +
                '<div class="stat-grid" style="margin: 2rem 0;">' +
                    '<div class="skeleton-pulse skeleton-card"></div>' +
                    '<div class="skeleton-pulse skeleton-card"></div>' +
                    '<div class="skeleton-pulse skeleton-card"></div>' +
                    '<div class="skeleton-pulse skeleton-card"></div>' +
                '</div>' +
                '<div class="skeleton-pulse skeleton-heading" style="width: 30%; margin-top: 2rem;"></div>' +
                Array(8).fill('<div class="skeleton-pulse skeleton-table-row"></div>').join('');
            var url = new URL(window.location.href);
            url.searchParams.set('period', newPeriod);
            window.location.href = url.toString();
        }

        document.querySelectorAll('.nav-inner a[href]').forEach(function(link) {
            link.addEventListener('click', function() {
                var main = document.querySelector('main');
                main.classList.add('skeleton');
                main.setAttribute('aria-busy', 'true');
                main.innerHTML =
                    '<div class="skeleton-pulse skeleton-heading"></div>' +
                    '<div class="skeleton-pulse skeleton-line skeleton-line-medium"></div>' +
                    '<div style="margin: 2rem 0;">' +
                        Array(6).fill('<div class="skeleton-pulse skeleton-table-row"></div>').join('') +
                    '</div>';
            });
        });
    </script>
</body>
</html>
